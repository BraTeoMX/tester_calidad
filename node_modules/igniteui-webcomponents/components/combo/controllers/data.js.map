{"version":3,"file":"data.js","sourceRoot":"","sources":["../../../../src/components/combo/controllers/data.ts"],"names":[],"mappings":"AAEA,OAAO,mBAAmB,MAAM,yBAAyB,CAAC;AAC1D,OAAO,kBAAkB,MAAM,wBAAwB,CAAC;AAQxD,MAAM,OAAO,cAAc;IAMzB,YAAsB,IAAkB;QAAlB,SAAI,GAAJ,IAAI,CAAc;QAL9B,aAAQ,GAAG,IAAI,kBAAkB,EAAK,CAAC;QACvC,cAAS,GAAG,IAAI,mBAAmB,EAAK,CAAC;QAC3C,gBAAW,GAAG,EAAE,CAAC;QACjB,qBAAgB,GAAG,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;QAG7C,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;IAChC,CAAC;IAED,IAAW,UAAU,CAAC,KAAa;QACjC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;QACzB,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;IACtC,CAAC;IAED,IAAW,UAAU;QACnB,OAAO,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;IAED,IAAW,gBAAgB;QACzB,OAAO,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC;IACpC,CAAC;IAED,IAAW,eAAe;QACxB,OAAO;YACL,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ;YAC5B,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,UAAU;YAChC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ;YAC5B,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,YAAY;SAClC,CAAC;IACJ,CAAC;IAED,IAAW,eAAe;QACxB,OAAO,IAAI,CAAC,gBAAgB,CAAC;IAC/B,CAAC;IAEO,KAAK,CAAC,IAAS;QACrB,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;YAChC,KAAK,EAAE,IAAI;YACX,MAAM,EAAE,KAAK;YACb,SAAS,EAAE,KAAK;SACjB,CAAC,CAAC,CAAC;IACN,CAAC;IAEM,aAAa,KAAI,CAAC;IAElB,KAAK,CAAC,KAAK,CAAC,IAAS;QAC1B,IAAI,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC/B,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAC9C,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAE7C,OAAO,OAAO,CAAC;IACjB,CAAC;CACF","sourcesContent":["import type { ReactiveController } from 'lit';\n\nimport FilterDataOperation from '../operations/filter.js';\nimport GroupDataOperation from '../operations/group.js';\nimport type {\n  ComboHost,\n  ComboRecord,\n  FilteringOptions,\n  GroupingOptions,\n} from '../types.js';\n\nexport class DataController<T extends object> implements ReactiveController {\n  protected grouping = new GroupDataOperation<T>();\n  protected filtering = new FilterDataOperation<T>();\n  private _searchTerm = '';\n  private _compareCollator = new Intl.Collator();\n\n  constructor(protected host: ComboHost<T>) {\n    this.host.addController(this);\n  }\n\n  public set searchTerm(value: string) {\n    this._searchTerm = value;\n    this.host.requestUpdate('pipeline');\n  }\n\n  public get searchTerm() {\n    return this._searchTerm;\n  }\n\n  public get filteringOptions(): FilteringOptions<T> {\n    return this.host.filteringOptions;\n  }\n\n  public get groupingOptions(): GroupingOptions<T> {\n    return {\n      valueKey: this.host.valueKey,\n      displayKey: this.host.displayKey,\n      groupKey: this.host.groupKey,\n      direction: this.host.groupSorting,\n    };\n  }\n\n  public get compareCollator(): Intl.Collator {\n    return this._compareCollator;\n  }\n\n  private index(data: T[]): ComboRecord<T>[] {\n    return data.map((item, index) => ({\n      value: item,\n      header: false,\n      dataIndex: index,\n    }));\n  }\n\n  public hostConnected() {}\n\n  public async apply(data: T[]): Promise<ComboRecord<T>[]> {\n    let records = this.index(data);\n    records = this.filtering.apply(records, this);\n    records = this.grouping.apply(records, this);\n\n    return records;\n  }\n}\n"]}