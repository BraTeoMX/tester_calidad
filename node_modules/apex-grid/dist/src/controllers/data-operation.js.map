{"version":3,"file":"data-operation.js","sourceRoot":"","sources":["../../../src/controllers/data-operation.ts"],"names":[],"mappings":"AACA,OAAO,iBAAiB,MAAM,uBAAuB,CAAC;AACtD,OAAO,mBAAmB,MAAM,yBAAyB,CAAC;AAG1D,OAAO,EAAE,SAAS,EAAE,MAAM,2BAA2B,CAAC;AAEtD,MAAM,OAAO,wBAAwB;IAInC,YAAsB,IAAiB;QAAjB,SAAI,GAAJ,IAAI,CAAa;QAH7B,YAAO,GAAG,IAAI,iBAAiB,EAAK,CAAC;QACrC,cAAS,GAAG,IAAI,mBAAmB,EAAK,CAAC;QAGjD,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;IAChC,CAAC;IAEM,aAAa,KAAI,CAAC;IAEzB,IAAc,aAAa;;QACzB,OAAO,SAAS,CAAC,MAAA,IAAI,CAAC,IAAI,CAAC,yBAAyB,0CAAE,IAAI,CAAC,CAAC;IAC9D,CAAC;IAED,IAAc,eAAe;;QAC3B,OAAO,SAAS,CAAC,MAAA,IAAI,CAAC,IAAI,CAAC,yBAAyB,0CAAE,MAAM,CAAC,CAAC;IAChE,CAAC;IAED,IAAc,YAAY;QACxB,OAAO,IAAI,CAAC,IAAI,CAAC,yBAA0B,CAAC,MAAO,CAAC;IACtD,CAAC;IAED,IAAc,UAAU;QACtB,OAAO,IAAI,CAAC,IAAI,CAAC,yBAA0B,CAAC,IAAK,CAAC;IACpD,CAAC;IAEM,KAAK,CAAC,KAAK,CAAC,IAAS,EAAE,KAAyB;QACrD,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,KAAK,CAAC;QAErC,IAAI,GAAG,IAAI,CAAC,eAAe;YACzB,CAAC,CAAC,MAAM,IAAI,CAAC,YAAY,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC;YACpE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,KAAK,CAAC,CAAC;QAEhD,IAAI,GAAG,IAAI,CAAC,aAAa;YACvB,CAAC,CAAC,MAAM,IAAI,CAAC,UAAU,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;YAChE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;QAE5C,OAAO,IAAI,CAAC;IACd,CAAC;CACF","sourcesContent":["import { ReactiveController } from 'lit';\nimport SortDataOperation from '../operations/sort.js';\nimport FilterDataOperation from '../operations/filter.js';\nimport type { GridHost } from '../internal/types.js';\nimport type { StateController } from './state.js';\nimport { isDefined } from '../internal/is-defined.js';\n\nexport class DataOperationsController<T extends object> implements ReactiveController {\n  protected sorting = new SortDataOperation<T>();\n  protected filtering = new FilterDataOperation<T>();\n\n  constructor(protected host: GridHost<T>) {\n    this.host.addController(this);\n  }\n\n  public hostConnected() {}\n\n  protected get hasCustomSort() {\n    return isDefined(this.host.dataPipelineConfiguration?.sort);\n  }\n\n  protected get hasCustomFilter() {\n    return isDefined(this.host.dataPipelineConfiguration?.filter);\n  }\n\n  protected get customFilter() {\n    return this.host.dataPipelineConfiguration!.filter!;\n  }\n\n  protected get customSort() {\n    return this.host.dataPipelineConfiguration!.sort!;\n  }\n\n  public async apply(data: T[], state: StateController<T>) {\n    const { filtering, sorting } = state;\n\n    data = this.hasCustomFilter\n      ? await this.customFilter({ data, grid: this.host, type: 'filter' })\n      : this.filtering.apply(data, filtering.state);\n\n    data = this.hasCustomSort\n      ? await this.customSort({ data, grid: this.host, type: 'sort' })\n      : this.sorting.apply(data, sorting.state);\n\n    return data;\n  }\n}\n"]}